"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.CardButton = void 0;
const jsx_runtime_1 = require("react/jsx-runtime");
const react_1 = require("react");
const classNames_1 = require("../../../commonHelpers/classNames/classNames");
const button_1 = require("../../../button/button");
const controlledMenu_1 = require("../../../menu/controlledMenu");
const iconChevronDownSmall_1 = require("../../../icons/iconChevronDownSmall");
const iconChevronTopSmall_1 = require("../../../icons/iconChevronTopSmall");
const menu_1 = require("../../../menu/menu");
const useDriveClassName_1 = require("../../../utils/theme/useDriveClassName");
const useDrive_1 = require("../../../utils/theme/useDrive");
const CardButton = ({ children, disabled = false, icon, name, onClick, link, className }) => {
    const [isOpen, setIsOpen] = (0, react_1.useState)(false);
    const triggerRef = (0, react_1.useRef)(null);
    const content = [];
    const cardButtonDriveClasses = (0, useDriveClassName_1.useDriveClassName)("zen-card-button");
    const isDrive = (0, useDrive_1.useDrive)();
    react_1.Children.forEach(children, (el) => {
        if (el.type === menu_1.Menu.Item) {
            content.push(el);
            return;
        }
    });
    const onButtonClickHandler = (...args) => {
        if (content.length) {
            setIsOpen(!isOpen);
            return;
        }
        onClick === null || onClick === void 0 ? void 0 : onClick(...args);
    };
    const renderLink = () => (0, jsx_runtime_1.jsxs)(button_1.Button, { disabled: disabled, type: "tertiary", link: link, title: name, className: (0, classNames_1.classNames)([className || "", "zen-card-button", "zen-caption", cardButtonDriveClasses || ""]), children: [icon && (0, react_1.createElement)(icon, { size: isDrive ? "huge" : "large", className: "zen-caption__pre-content" }), (0, jsx_runtime_1.jsx)("span", { className: "zen-caption__content", children: name })] });
    const renderButton = () => {
        const trigger = (0, jsx_runtime_1.jsxs)(button_1.Button, { htmlType: "button", ref: triggerRef, disabled: disabled, type: "tertiary", onClick: onButtonClickHandler, title: name, className: (0, classNames_1.classNames)([className || "", "zen-card-button", "zen-caption", cardButtonDriveClasses || ""]), children: [icon && (0, react_1.createElement)(icon, { size: isDrive ? "huge" : "large", className: "zen-caption__pre-content" }), (0, jsx_runtime_1.jsx)("span", { className: "zen-caption__content", children: name }), !!content.length && (isOpen ? (0, jsx_runtime_1.jsx)(iconChevronTopSmall_1.IconChevronTopSmall, { size: isDrive ? "huge" : "large", className: "zen-caption__post-content" }) : (0, jsx_runtime_1.jsx)(iconChevronDownSmall_1.IconChevronDownSmall, { size: isDrive ? "huge" : "large", className: "zen-caption__post-content" }))] });
        return content.length ? (0, jsx_runtime_1.jsxs)(jsx_runtime_1.Fragment, { children: [trigger, (0, jsx_runtime_1.jsx)(controlledMenu_1.ControlledMenu, { title: name, isOpen: isOpen, setIsOpen: setIsOpen, triggerRef: triggerRef, children: content })] }) : trigger;
    };
    return !link && !onClick ? renderButton() : onClick ? renderButton() : renderLink();
};
exports.CardButton = CardButton;
