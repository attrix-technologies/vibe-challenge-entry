"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.FormStepper = void 0;
const jsx_runtime_1 = require("react/jsx-runtime");
const react_1 = require("react");
const formStep_1 = require("./components/formStep");
const useMobile_1 = require("../commonHelpers/hooks/useMobile");
const useLanguage_1 = require("../utils/localization/useLanguage");
const MAX_STEPS = 7;
const FormStepper = ({ steps, onStepClicked, className = "", current, errors, setCurrent }) => {
    const activeStepIndex = (0, react_1.useMemo)(() => steps.findIndex(step => step.id === current) || 0, [steps, current]);
    const isMobile = (0, useMobile_1.useMobile)();
    const { translate } = (0, useLanguage_1.useLanguage)();
    const adjustedSteps = (0, react_1.useMemo)(() => {
        if (steps.length > MAX_STEPS) {
            return steps.slice(0, MAX_STEPS);
        }
        return steps;
    }, [steps]);
    const onStepClickedHandler = (0, react_1.useCallback)((id) => {
        setCurrent(id);
        onStepClicked === null || onStepClicked === void 0 ? void 0 : onStepClicked(id);
    }, [setCurrent, onStepClicked]);
    const isOptionalStep = isMobile && adjustedSteps[activeStepIndex].optional;
    return (0, jsx_runtime_1.jsxs)("div", { className: `zen-form-stepper ${className}`, role: "tablist", children: [(0, jsx_runtime_1.jsx)("div", { className: "zen-form-stepper__steps", children: adjustedSteps.map((step, indx) => ((0, jsx_runtime_1.jsx)(formStep_1.FormStep, { id: step.id, label: step.label, isFirst: step.id === steps[0].id, value: indx + 1, onClick: () => onStepClickedHandler(step.id), isError: errors === null || errors === void 0 ? void 0 : errors.includes(step.id), isCurrent: current === step.id, isComplete: indx < activeStepIndex, optional: step.optional }, step.id))) }), isMobile && (0, jsx_runtime_1.jsxs)("label", { className: "zen-form-stepper__mobile-labels", children: [(0, jsx_runtime_1.jsx)("span", { className: "zen-form-stepper__mobile-counter", children: translate("Step {0} of {1}").replace("{0}", String(activeStepIndex + 1)).replace("{1}", String(adjustedSteps.length)) }), (0, jsx_runtime_1.jsx)("span", { title: adjustedSteps[activeStepIndex].label, className: "zen-form-stepper__mobile-label", children: adjustedSteps[activeStepIndex].label }), (0, jsx_runtime_1.jsx)("span", { title: translate("Optional"), className: `zen-form-stepper__mobile-secondary-label ${isOptionalStep ? "zen-form-stepper__mobile-secondary-label--visible" : ""}`, children: translate("Optional") })] })] });
};
exports.FormStepper = FormStepper;
