"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.Pagination = void 0;
const jsx_runtime_1 = require("react/jsx-runtime");
const react_1 = require("react");
const classNames_1 = require("../commonHelpers/classNames/classNames");
const paginationArrow_1 = require("./paginationArrow");
const paginationButtonsRow_1 = require("./paginationButtonsRow");
const paginationText_1 = require("./paginationText/paginationText");
const paginationType_1 = require("./paginationType");
const Pagination = ({ className, activePage, total, perPage, onChange, disabled, includeText = false, type = paginationType_1.PaginationType.Compact, gridRef }) => {
    var _a, _b;
    const gridNode = ((_a = gridRef === null || gridRef === void 0 ? void 0 : gridRef.current) === null || _a === void 0 ? void 0 : _a.classList.contains("zen-data-grid")) ?
        gridRef.current : (_b = gridRef === null || gridRef === void 0 ? void 0 : gridRef.current) === null || _b === void 0 ? void 0 : _b.querySelector(".zen-data-grid");
    const displayedPagesCount = 6;
    const totalNumberOfPages = (0, react_1.useMemo)(() => Math.ceil(total / perPage), [total, perPage]);
    const getPaginationValues = () => {
        const paginationArr = [];
        const isBeginningOfPaginationRange = () => activePage <= Math.round(displayedPagesCount / 2) || totalNumberOfPages <= displayedPagesCount;
        const isEndOfPaginationRange = () => activePage >= totalNumberOfPages - Math.round(displayedPagesCount / 2) || totalNumberOfPages <= displayedPagesCount;
        if (totalNumberOfPages < displayedPagesCount) {
            for (let i = 0; i < totalNumberOfPages; i++) {
                paginationArr[i] = i;
            }
        }
        else if (isBeginningOfPaginationRange()) {
            for (let i = 0; i < displayedPagesCount; i++) {
                paginationArr[i] = i;
            }
        }
        else if (isEndOfPaginationRange()) {
            paginationArr[0] = 0;
            for (let i = 1; i < displayedPagesCount; i++) {
                paginationArr[i] = totalNumberOfPages - displayedPagesCount + i;
            }
        }
        else {
            paginationArr[0] = 0;
            let firstNumberInRange = activePage - 2;
            for (let i = 1; i < displayedPagesCount; i++) {
                paginationArr[i] = firstNumberInRange++;
            }
        }
        return paginationArr;
    };
    const handlePageChange = (newActivePage) => {
        onChange(newActivePage);
        if (gridNode && typeof gridNode.scrollTo === "function") {
            gridNode.scrollTo({ top: 0, behavior: "instant" });
        }
    };
    const isSinglePage = total <= perPage;
    return (0, jsx_runtime_1.jsxs)("div", { className: (0, classNames_1.classNames)(["zen-pagination", `zen-pagination--type-${type}`, className ? className : ""]), children: [includeText
                ? (0, jsx_runtime_1.jsx)(paginationText_1.PaginationText, { amount: total, from: total === 0 ? total : activePage * perPage + 1, to: Math.min((activePage + 1) * perPage, total) })
                : null, isSinglePage
                ? null
                : (0, jsx_runtime_1.jsx)(paginationArrow_1.PaginationArrow, { value: "previous", disabled: activePage === 0 || disabled, arrowButtonHandler: () => handlePageChange(activePage - 1), type: type }), type === paginationType_1.PaginationType.Normal
                ? (0, jsx_runtime_1.jsx)(paginationButtonsRow_1.PaginationButtonsRow, { paginationValues: getPaginationValues(), activePage: activePage, upperBoundIndex: totalNumberOfPages - 1, onChange: handlePageChange })
                : null, isSinglePage
                ? null
                : (0, jsx_runtime_1.jsx)(paginationArrow_1.PaginationArrow, { value: "next", disabled: activePage >= totalNumberOfPages - 1 || disabled, arrowButtonHandler: () => handlePageChange(activePage + 1), type: type })] });
};
exports.Pagination = Pagination;
