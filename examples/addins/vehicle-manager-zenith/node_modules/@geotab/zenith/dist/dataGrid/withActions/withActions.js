"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.withActions = void 0;
const jsx_runtime_1 = require("react/jsx-runtime");
const react_1 = require("react");
const toBasicColumn_1 = require("../extensions/toBasicColumn");
const actionsColumn_1 = require("../columns/actionsColumn/actionsColumn");
// T - type of entity
// P - props of wrapped component
// eslint-disable-next-line @typescript-eslint/naming-convention
const withActions = (DataGridComponent) => (0, react_1.forwardRef)(
// eslint-disable-next-line @typescript-eslint/naming-convention
function InnerColumnsList(props, ref) {
    const { columns } = props;
    let actions = undefined;
    let actionsAsync = undefined;
    const columnsWithActions = columns.find(el => el.columnComponent instanceof actionsColumn_1.ActionsColumn);
    if (columnsWithActions && columnsWithActions.columnComponent) {
        const colComp = columnsWithActions.columnComponent;
        const colActions = colComp.columnActions;
        actions = colActions ? colActions : undefined;
        actionsAsync = colComp.columnActionsAsync;
    }
    const allColumns = (0, react_1.useMemo)(() => columns.filter(el => !(el.columnComponent instanceof actionsColumn_1.ActionsColumn)).map(column => (Object.assign({}, (0, toBasicColumn_1.toBasicColumn)(Object.assign({}, column))))), [columns]);
    return (0, jsx_runtime_1.jsx)(DataGridComponent, Object.assign({}, props, { columns: [...allColumns], actions: actions, actionsAsync: actionsAsync, ref: ref }), "grid");
});
exports.withActions = withActions;
