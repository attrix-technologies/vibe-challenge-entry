"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.useEscape = void 0;
const react_1 = require("react");
const focusableSelector_1 = require("../../utils/focusableSelector");
const isChildOf_1 = require("../../utils/isChildOf");
const useKeydown_1 = require("./useKeydown");
const useEscape = (containerRef, callback, subscriptionTrigger, condition) => {
    const handleKeyDown = (0, react_1.useCallback)((e) => {
        if (e.key === "Escape") {
            const target = e.target;
            if (!target || !containerRef.current) {
                return;
            }
            const isPopupFocused = (0, isChildOf_1.isChildOf)(target, containerRef.current);
            const focusable = containerRef.current.querySelectorAll(focusableSelector_1.FOCUSABLE_SELECTOR);
            if (isPopupFocused || !focusable.length) {
                callback(e);
                return;
            }
        }
    }, [callback, containerRef]);
    (0, useKeydown_1.useKeydown)(handleKeyDown, subscriptionTrigger, condition);
};
exports.useEscape = useEscape;
