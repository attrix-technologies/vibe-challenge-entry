"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.usePillSize = void 0;
const react_1 = require("react");
const classNames_1 = require("../classNames/classNames");
const useResize_1 = require("./useResize");
const useDriveClassName_1 = require("../../utils/theme/useDriveClassName");
const PILL_WIDTH_WITHOUT_CONTENT = 64;
const usePillSize = ({ size, iconPosition, onClose, hasContent }) => {
    const isFixedSize = size && size !== "default" && size !== "fullWidth";
    const hasIcon = !!iconPosition;
    const isClosable = !!onClose;
    const [isContentHidden, setIsContentHidden] = (0, react_1.useState)(false);
    const ref = (0, react_1.useRef)(null);
    const [title, setTitle] = (0, react_1.useState)("");
    const driveClass = (0, useDriveClassName_1.useDriveClassName)("zen-pill-new-content");
    const contentClasses = (0, classNames_1.classNames)([
        "zen-pill-new-content",
        driveClass || "",
        iconPosition === "left" ? "zen-pill-new-content--icon-left" : iconPosition === "right" ? "zen-pill-new-content--icon-right" : "",
        isContentHidden ? "zen-pill-new-content--hidden" : "",
        isClosable ? "zen-pill-new-content--closable" : "",
        !hasContent ? "zen-pill-new-content--empty" : ""
    ]);
    const hidePillContent = (0, react_1.useCallback)(() => {
        var _a;
        if (!((_a = ref.current) === null || _a === void 0 ? void 0 : _a.clientWidth)) {
            return;
        }
        if (ref.current.clientWidth <= PILL_WIDTH_WITHOUT_CONTENT) {
            setIsContentHidden(true);
        }
        else {
            setIsContentHidden(false);
        }
    }, []);
    (0, useResize_1.useResize)(() => {
        if (isFixedSize || (hasIcon && !isClosable) || (!hasIcon && isClosable)) {
            return;
        }
        hidePillContent();
    }, true);
    (0, react_1.useLayoutEffect)(() => {
        if (ref.current) {
            setTitle(ref.current.textContent || "");
        }
        if ((hasIcon && !isClosable) || (!hasIcon && isClosable)) {
            return;
        }
        hidePillContent();
    }, [hidePillContent, isFixedSize, isClosable, hasIcon]);
    return { contentClasses, ref, title, isFixedSize, isTextContentHidden: isContentHidden && isClosable && hasIcon };
};
exports.usePillSize = usePillSize;
