"use strict";
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
exports.regulatePageHeaderChildren = exports.getItemsFromFragments = void 0;
const jsx_runtime_1 = require("react/jsx-runtime");
const headerHelpers_1 = require("../header/headerHelpers");
const react_1 = __importDefault(require("react"));
const filters_1 = require("../filters/filters");
const pageHeaderFilters_1 = require("./pageHeaderFilters");
const pageHeaderActions_1 = require("./pageHeaderActions");
const pageHeaderButton_1 = require("./pageHeaderButton");
const pageHeaderMenu_1 = require("./pageHeaderMenu");
const getItemsFromFragments = (items) => {
    const itemsArr = [];
    react_1.default.Children.forEach(items, (child) => {
        if (react_1.default.isValidElement(child) && child.type === react_1.default.Fragment) {
            if (child.props && child.props.children) {
                const fragmentArr = (0, headerHelpers_1.getArrayOfChildren)(child.props.children);
                itemsArr.push(...fragmentArr.filter((el) => react_1.default.isValidElement(el)));
            }
        }
        else if (react_1.default.isValidElement(child)) {
            itemsArr.push(child);
        }
    });
    return itemsArr;
};
exports.getItemsFromFragments = getItemsFromFragments;
const regulatePageHeaderChildren = (children) => {
    const filters = [];
    const actions = [];
    const wrappedActions = [];
    const childrenArray = (0, headerHelpers_1.getArrayOfChildren)(children).filter((child) => child !== null && child !== undefined);
    const preparedChildrenArr = (0, exports.getItemsFromFragments)(childrenArray);
    // eslint-disable-next-line complexity
    preparedChildrenArr.forEach((child) => {
        const isValidElement = react_1.default.isValidElement(child);
        if (!filters.length && isValidElement && (child.type === pageHeaderFilters_1.PageHeaderFilters)) {
            filters.push(child);
            return;
        }
        if (!filters.length && isValidElement && (child.type === filters_1.Filters || child.type.displayName === filters_1.FiltersDisplayName)) {
            filters.push((0, jsx_runtime_1.jsx)(pageHeaderFilters_1.PageHeaderFilters, { children: child }, "page-header-filters-key"));
            return;
        }
        if (!wrappedActions.length && isValidElement && (child.type === pageHeaderActions_1.PageHeaderActions)) {
            wrappedActions.push(child);
            return;
        }
        if (isValidElement && (child.type === pageHeaderButton_1.PageHeaderButton || child.type === pageHeaderMenu_1.PageHeaderMenu)) {
            actions.push(child);
            return;
        }
    });
    if (wrappedActions.length === 0 && actions.length > 0) {
        wrappedActions.push((0, jsx_runtime_1.jsx)(pageHeaderActions_1.PageHeaderActions, { children: actions }, "page-header-actions-key"));
    }
    return [filters, wrappedActions];
};
exports.regulatePageHeaderChildren = regulatePageHeaderChildren;
