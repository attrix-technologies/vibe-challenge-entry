"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.Dialog = void 0;
const jsx_runtime_1 = require("react/jsx-runtime");
const react_1 = require("react");
const react_dom_1 = require("react-dom");
const dialogContent_1 = require("./dialogContent");
const dialogHelpers_1 = require("./dialogHelpers");
const themeContext_1 = require("../utils/theme/themeContext");
const classNames_1 = require("../commonHelpers/classNames/classNames");
const useBodyScroll_1 = require("../utils/useBodyScroll");
/**
 * @deprecated - use Modal instead
*/
const Dialog = ({ isOpen, children, isElementVisible }) => {
    const lastActiveOutsideElement = (0, react_1.useRef)(document.activeElement);
    const modalRoot = document.fullscreenElement || document.body;
    const { dark } = (0, react_1.useContext)(themeContext_1.themeContext);
    const { resetScroll } = (0, useBodyScroll_1.useBodyScroll)();
    (0, react_1.useEffect)(() => {
        const copyActive = lastActiveOutsideElement.current;
        return () => {
            (0, dialogHelpers_1.isFocusable)(copyActive) && copyActive.focus();
        };
    }, []);
    (0, react_1.useEffect)(() => {
        if (isOpen) {
            return;
        }
        const modalCont = document.body.querySelectorAll(".zen-dialog");
        if (!modalCont.length) {
            resetScroll();
        }
    }, [isOpen, resetScroll]);
    const labeledId = (0, react_1.useId)();
    const darkClass = dark ? "zen-dark" : "";
    const createDialog = (id) => (0, jsx_runtime_1.jsxs)("div", { className: (0, classNames_1.classNames)(["zen-dialog", darkClass]), "aria-modal": "true", role: "dialog", "aria-labelledby": labeledId, style: { top: `${window.pageYOffset}px` }, children: [(0, jsx_runtime_1.jsx)(dialogContent_1.DialogContent, Object.assign({}, children.props, { labeledId: id, isElementVisible: isElementVisible })), (0, jsx_runtime_1.jsx)("div", { className: "zen-dialog__shield" })] });
    return (0, react_dom_1.createPortal)(isOpen && (0, react_1.isValidElement)(children) ? createDialog(labeledId) : null, modalRoot, "ModalPortal");
};
exports.Dialog = Dialog;
