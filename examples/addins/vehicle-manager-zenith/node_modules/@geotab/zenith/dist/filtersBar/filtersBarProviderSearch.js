"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.useSearchComponent = exports.SearchContextProvider = exports.SearchContext = void 0;
const jsx_runtime_1 = require("react/jsx-runtime");
const react_1 = require("react");
const getNumberOfChangedFilters_1 = require("./utils/getNumberOfChangedFilters");
exports.SearchContext = (0, react_1.createContext)({
    setSearchComponent: () => { }
});
const SearchContextProvider = ({ value, children }) => {
    const searchComponentRef = (0, react_1.useRef)(null);
    const setSearchComponentRef = (0, react_1.useCallback)((searchComponent) => {
        const prevProps = searchComponentRef.current === null || !searchComponentRef.current ? undefined : searchComponentRef.current.props;
        const nextProps = !searchComponent ? undefined : searchComponent.props;
        const changedPropsNumber = prevProps && !nextProps || !prevProps && nextProps ? 1 :
            (0, getNumberOfChangedFilters_1.getNumberOfChangedFilters)(prevProps || {}, nextProps || {});
        searchComponentRef.current = searchComponent;
        if (changedPropsNumber > 0) {
            setTimeout(() => {
                value.setSearchComponent(searchComponent);
            }, 0);
        }
    }, [value]);
    return (0, jsx_runtime_1.jsx)(exports.SearchContext.Provider, { value: { setSearchComponent: setSearchComponentRef }, children: children });
};
exports.SearchContextProvider = SearchContextProvider;
const useSearchComponent = () => {
    const { setSearchComponent } = (0, react_1.useContext)(exports.SearchContext);
    return { setSearchComponent };
};
exports.useSearchComponent = useSearchComponent;
