"use strict";
var __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    var desc = Object.getOwnPropertyDescriptor(m, k);
    if (!desc || ("get" in desc ? !m.__esModule : desc.writable || desc.configurable)) {
      desc = { enumerable: true, get: function() { return m[k]; } };
    }
    Object.defineProperty(o, k2, desc);
}) : (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    o[k2] = m[k];
}));
var __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {
    Object.defineProperty(o, "default", { enumerable: true, value: v });
}) : function(o, v) {
    o["default"] = v;
});
var __importStar = (this && this.__importStar) || function (mod) {
    if (mod && mod.__esModule) return mod;
    var result = {};
    if (mod != null) for (var k in mod) if (k !== "default" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);
    __setModuleDefault(result, mod);
    return result;
};
Object.defineProperty(exports, "__esModule", { value: true });
exports.RadioGroup = void 0;
const jsx_runtime_1 = require("react/jsx-runtime");
const react_1 = require("react");
const react_2 = __importStar(require("react"));
const radio_1 = require("../radio/radio");
const classNames_1 = require("../commonHelpers/classNames/classNames");
const react_3 = require("react");
const RadioGroup = ({ fullWidth, reverse, id, items, className, name, value, disabled, type = "static", direction = "horizontal", onChange, selectItemOnFocus = true, wrappedInLabel }) => {
    const generatedId = react_2.default.useId();
    const intId = id || generatedId;
    const [focusedIndex, setFocusedIndex] = (0, react_2.useState)(items.findIndex(el => el.value === value));
    const focusElementRef = (0, react_2.useRef)(null);
    const classes = "zen-radio-group zen-radio-group--" + direction + (disabled ? " zen-radio-group--disabled" : "");
    const findNextEnabledIndex = (0, react_2.useCallback)((currentIndex) => {
        var _a;
        let newIndex = (currentIndex + 1) % items.length;
        while ((_a = items[newIndex]) === null || _a === void 0 ? void 0 : _a.disabled) {
            newIndex = (newIndex + 1) % items.length;
        }
        return newIndex;
    }, [items]);
    const findPrevEnabledIndex = (0, react_2.useCallback)((currentIndex) => {
        var _a;
        let newIndex = (currentIndex - 1 + items.length) % items.length;
        while ((_a = items[newIndex]) === null || _a === void 0 ? void 0 : _a.disabled) {
            newIndex = (newIndex - 1 + items.length) % items.length;
        }
        return newIndex;
    }, [items]);
    const handleKeyDown = (e) => {
        var _a;
        if (e.key === "ArrowDown" || e.key === "ArrowRight") {
            e.preventDefault();
            const newIndex = findNextEnabledIndex(focusedIndex);
            setFocusedIndex(newIndex);
        }
        else if (e.key === "ArrowUp" || e.key === "ArrowLeft") {
            e.preventDefault();
            const newIndex = findPrevEnabledIndex(focusedIndex);
            setFocusedIndex(newIndex);
        }
        else if (e.key === "Enter") {
            (_a = focusElementRef.current) === null || _a === void 0 ? void 0 : _a.focus();
            onChange && onChange(e);
        }
    };
    (0, react_3.useEffect)(() => {
        var _a;
        (_a = focusElementRef.current) === null || _a === void 0 ? void 0 : _a.focus();
    }, [focusedIndex]);
    const extraProps = selectItemOnFocus ? {} : ({ role: "radiogroup", tabIndex: 0 });
    return (0, jsx_runtime_1.jsx)("div", { id: intId, className: (0, classNames_1.classNames)([classes, className || ""]), children: (0, jsx_runtime_1.jsx)("div", Object.assign({ className: "zen-radio-group__wrapper", onKeyDown: selectItemOnFocus ? undefined : handleKeyDown }, extraProps, { children: items.map((item, ind) => (0, react_1.createElement)(radio_1.Radio, Object.assign({}, item, { className: (0, classNames_1.classNames)(["zen-radio-group__item", wrappedInLabel ? "zen-radio-group__item--no-paddings" : "", type === "interactive" ? "zen-radio--interactive" : ""]), key: ind, checked: item.value === value, disabled: disabled ? disabled : item.disabled, name: name, reverse: reverse, fullWidth: fullWidth, value: item.value, onChange: onChange, wrappedInLabel: wrappedInLabel, tabIndex: selectItemOnFocus || disabled || item.disabled ? undefined : (ind === focusedIndex ? 0 : -1), ref: selectItemOnFocus ? undefined : (ind === focusedIndex ? focusElementRef : null) }), item.children)) })) });
};
exports.RadioGroup = RadioGroup;
