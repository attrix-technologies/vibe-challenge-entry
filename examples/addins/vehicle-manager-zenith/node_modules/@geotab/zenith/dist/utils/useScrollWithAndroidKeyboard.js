"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.useScrollWithAndroidKeyboard = void 0;
const react_1 = require("react");
const generateId_1 = require("../commonHelpers/generateId");
const useScrollWithAndroidKeyboard = () => {
    const [uniqueKey] = (0, react_1.useState)(() => (0, generateId_1.generateId)());
    const wrapperClass = `zen-mobile-sheet-wrapper__${uniqueKey}`;
    const mobileSheetClass = "zen-mobile-sheet";
    const additionalWrapperClass = "zen-side-panel--shown-keyboard";
    const additionalMobileSheetClass = "zen-mobile-sheet--mobile-android";
    const addKeyboardClasses = (0, react_1.useCallback)(() => {
        const wrapperElem = document.body.querySelector(`.${wrapperClass}`);
        const mobileSheetElem = wrapperElem === null || wrapperElem === void 0 ? void 0 : wrapperElem.querySelector(`.${mobileSheetClass}`);
        if (!wrapperElem) {
            return;
        }
        wrapperElem.classList.add(additionalWrapperClass);
        mobileSheetElem === null || mobileSheetElem === void 0 ? void 0 : mobileSheetElem.classList.add(additionalMobileSheetClass);
    }, [wrapperClass]);
    const handleFocus = (0, react_1.useCallback)(() => {
        var _a;
        const isAndroid = navigator.userAgent.toLowerCase().includes("android");
        if (!isAndroid) {
            return;
        }
        (_a = window.visualViewport) === null || _a === void 0 ? void 0 : _a.addEventListener("resize", addKeyboardClasses, { once: true });
    }, [addKeyboardClasses]);
    const handleBlur = (0, react_1.useCallback)(() => {
        setTimeout(() => {
            const wrapperElem = document.body.querySelector(`.${wrapperClass}`);
            const mobileSheetElem = wrapperElem === null || wrapperElem === void 0 ? void 0 : wrapperElem.querySelector(`.${mobileSheetClass}`);
            wrapperElem === null || wrapperElem === void 0 ? void 0 : wrapperElem.classList.remove(additionalWrapperClass);
            mobileSheetElem === null || mobileSheetElem === void 0 ? void 0 : mobileSheetElem.classList.remove(additionalMobileSheetClass);
        }, 100);
    }, [wrapperClass]);
    return { handleFocus, handleBlur, wrapperClass };
};
exports.useScrollWithAndroidKeyboard = useScrollWithAndroidKeyboard;
