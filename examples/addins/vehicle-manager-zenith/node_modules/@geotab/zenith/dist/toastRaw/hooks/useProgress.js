"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.useProgress = exports.MIN_SECONDS_TO_SHOW = void 0;
const react_1 = require("react");
exports.MIN_SECONDS_TO_SHOW = 7;
const useProgress = ({ isOpen, onClose, showSeconds = exports.MIN_SECONDS_TO_SHOW }) => {
    const [progress, setProgress] = (0, react_1.useState)(100);
    const isFinishedRef = (0, react_1.useRef)(false);
    const seconds = showSeconds <= 0 ? exports.MIN_SECONDS_TO_SHOW : showSeconds;
    (0, react_1.useEffect)(() => {
        if (isOpen && !isFinishedRef.current) {
            const interval = setInterval(() => {
                setProgress((prev) => {
                    if (isFinishedRef.current) {
                        return prev;
                    }
                    if (prev < 0) {
                        clearInterval(interval);
                        isFinishedRef.current = true;
                        setTimeout(onClose);
                        return 0;
                    }
                    return prev - 1;
                });
            }, seconds * 10);
            return () => clearInterval(interval);
        }
        return undefined;
    }, [isOpen, onClose, seconds, showSeconds]);
    return { progress };
};
exports.useProgress = useProgress;
