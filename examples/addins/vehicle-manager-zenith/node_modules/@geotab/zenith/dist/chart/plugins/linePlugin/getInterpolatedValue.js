"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.getInterpolatedValue = void 0;
function getInterpolatedValue(xScale, data, datasetIndex, xPixel) {
    const dataset = data.datasets[datasetIndex];
    const dataPoints = dataset.data;
    if (dataPoints.length < 2) {
        return null;
    }
    let lowerPoint = undefined;
    let upperPoint = undefined;
    let lowerXPixel = -Infinity;
    let upperXPixel = Infinity;
    for (let i = 0; i < dataPoints.length; i++) {
        const point = dataPoints[i];
        const x = point.x;
        const y = point.y;
        if (y === null) {
            continue;
        }
        const pointXPixel = xScale.getPixelForValue(x);
        if (pointXPixel <= xPixel && pointXPixel > lowerXPixel) {
            lowerPoint = y;
            lowerXPixel = pointXPixel;
        }
        if (pointXPixel >= xPixel && pointXPixel < upperXPixel) {
            upperPoint = y;
            upperXPixel = pointXPixel;
        }
    }
    if (!lowerPoint || !upperPoint) {
        return null;
    }
    // Perform linear interpolation
    const x = xPixel;
    const x1 = lowerXPixel;
    const y1 = lowerPoint;
    const x2 = upperXPixel;
    const y2 = upperPoint;
    if (x1 === x2) {
        return y1;
    }
    const interpolatedY = y1 + (y2 - y1) * (x - x1) / (x2 - x1);
    return interpolatedY;
}
exports.getInterpolatedValue = getInterpolatedValue;
