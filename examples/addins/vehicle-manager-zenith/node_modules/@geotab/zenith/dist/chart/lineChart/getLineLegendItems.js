"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.getLineLegendItems = void 0;
const formatValue_1 = require("../plugins/legend/formatValue");
const getLatestValue = (dataset) => {
    if (dataset.data.length === 0) {
        return 0;
    }
    for (let i = dataset.data.length - 1; i >= 0; i--) {
        const point = dataset.data[i];
        if (typeof point === "number") {
            return point;
        }
        if (typeof point === "object" && point.y && point.x) {
            return point.y;
        }
    }
    return 0;
};
const getLineLegendItems = (data, options) => {
    if (data.datasets.length === 0) {
        return [];
    }
    const legendItems = data.datasets.map((dataset, index) => {
        if (dataset.parentIndex !== undefined) {
            return undefined;
        }
        return {
            color: typeof dataset.borderColor === "string" ? dataset.borderColor : "",
            text: dataset.label || "",
            value: (0, formatValue_1.formatValue)(getLatestValue(dataset).toFixed(2), index, options === null || options === void 0 ? void 0 : options.unit),
            index: index,
            hidden: false
        };
    }).filter(item => item !== undefined);
    return legendItems;
};
exports.getLineLegendItems = getLineLegendItems;
