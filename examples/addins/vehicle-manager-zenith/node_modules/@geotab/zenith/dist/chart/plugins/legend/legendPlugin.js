"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.legendPlugin = exports.LEGEND_PLUGIN_ID = void 0;
const renderLegend_1 = require("./renderLegend");
const getLineLegendItems_1 = require("../../lineChart/getLineLegendItems");
const getBarLegendItems_1 = require("../../barChart/getBarLegendItems");
const getPieLegendItems_1 = require("../../pieChart/getPieLegendItems");
exports.LEGEND_PLUGIN_ID = "zenithLegend";
const legendPlugin = (containerId, options, isDrive, isHidden, toggleHidden) => ({
    id: exports.LEGEND_PLUGIN_ID,
    isDrive: isDrive,
    afterUpdate(chart) {
        const container = document.getElementById(containerId);
        if (!container) {
            return;
        }
        if (options === false) {
            container.classList.add("zen-legend--hidden");
            return;
        }
        container.innerHTML = "";
        // eslint-disable-next-line @typescript-eslint/no-explicit-any
        const chartType = chart.config.type;
        let items = [];
        if (chartType === "line") {
            items = (0, getLineLegendItems_1.getLineLegendItems)(chart.data, options);
        }
        if (chartType === "bar") {
            items = (0, getBarLegendItems_1.getBarLegendItems)(chart.data);
        }
        if (chartType === "pie") {
            items = (0, getPieLegendItems_1.getPieLegendItems)(chart.data, options, isHidden);
        }
        items = items.map(item => {
            const onClick = () => {
                toggleHidden(item.index);
                chart.update();
            };
            return Object.assign(Object.assign({}, item), { onClick, hidden: isHidden(item.index) });
        });
        if (items.length === 0) {
            container.classList.add("zen-legend--hidden");
            return;
        }
        container.classList.remove("zen-legend--hidden");
        (0, renderLegend_1.renderLegend)(container, this.isDrive, items);
    }
});
exports.legendPlugin = legendPlugin;
