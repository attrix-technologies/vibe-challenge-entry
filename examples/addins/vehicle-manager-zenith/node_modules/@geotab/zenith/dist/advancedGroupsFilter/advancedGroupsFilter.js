"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.TRANSLATIONS = exports.AdvancedGroupsFilter = void 0;
const jsx_runtime_1 = require("react/jsx-runtime");
const react_1 = require("react");
const advancedGroupsFilterFormHelper_1 = require("./advancedGroupsFilterFormHelper");
const advancedGroupsFilterForm_1 = require("./advancedGroupsFilterForm");
const classNames_1 = require("../commonHelpers/classNames/classNames");
const useLanguage_1 = require("../utils/localization/useLanguage");
const modal_1 = require("../modal/modal");
const AdvancedGroupsFilter = ({ isOpen, onClose, onApply, state, className, getData, errorHandler, dataItems, tooltipText }) => {
    //const dropdownFocusedListClasses = ["zen-dropdown-searchable-trigger__input", "zen-dropdown-searchable-trigger__popup-trigger"];
    const [currentState, setCurrentState] = (0, react_1.useState)((0, advancedGroupsFilterFormHelper_1.prepareCurrentFilterState)(state));
    const [dataItemsValue, setDataItemsValue] = (0, react_1.useState)(dataItems || []);
    const { translate } = (0, useLanguage_1.useLanguage)();
    const handleClose = () => {
        onClose();
    };
    (0, react_1.useEffect)(() => {
        const timeoutId = setTimeout(() => {
            if (!dataItemsValue.length) {
                getData().then((data) => {
                    setDataItemsValue(data);
                }).catch((e) => {
                    errorHandler(e);
                });
            }
        });
        return () => clearTimeout(timeoutId);
    }, [getData, errorHandler, dataItemsValue.length]);
    const handleApply = () => {
        onApply((0, advancedGroupsFilterFormHelper_1.prepareToFilterState)(currentState));
    };
    return (0, jsx_runtime_1.jsxs)(modal_1.Modal, { title: translate("Advanced groups filter"), className: (0, classNames_1.classNames)(["zen-advanced-groups-filter", className || ""]), isOpen: isOpen, onClose: handleClose, children: [(0, jsx_runtime_1.jsx)(advancedGroupsFilterForm_1.AdvancedGroupsFilterForm, { dataItems: dataItemsValue, getData: getData, errorHandler: errorHandler, state: currentState, onStateChange: setCurrentState, tooltipText: tooltipText }), (0, jsx_runtime_1.jsx)(modal_1.Modal.SecondaryButton, { onClick: onClose, children: translate("Cancel") }), (0, jsx_runtime_1.jsx)(modal_1.Modal.PrimaryButton, { onClick: handleApply, children: translate("Apply") })] });
};
exports.AdvancedGroupsFilter = AdvancedGroupsFilter;
exports.TRANSLATIONS = [
    ...advancedGroupsFilterForm_1.TRANSLATIONS,
    "Cancel",
    "Apply",
    "Advanced groups filter"
];
